"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[352],{3905:function(e,t,n){n.d(t,{Zo:function(){return c},kt:function(){return m}});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),d=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=d(e.components);return a.createElement(s.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),h=d(n),m=r,p=h["".concat(s,".").concat(m)]||h[m]||u[m]||o;return n?a.createElement(p,i(i({ref:t},c),{},{components:n})):a.createElement(p,i({ref:t},c))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var d=2;d<o;d++)i[d]=n[d];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},9446:function(e,t,n){n.r(t),n.d(t,{assets:function(){return c},contentTitle:function(){return s},default:function(){return m},frontMatter:function(){return l},metadata:function(){return d},toc:function(){return u}});var a=n(7462),r=n(3366),o=(n(7294),n(3905)),i=["components"],l={title:"Lecture",sidebar_label:"Lecture",pagination_next:null,pagination_prev:null,hide_table_of_contents:!1},s="Lecture",d={unversionedId:"lecture-13/lecture",id:"lecture-13/lecture",title:"Lecture",description:"Lecture Slides will be in OMA after the session.",source:"@site/docs/lecture-13/lecture.md",sourceDirName:"lecture-13",slug:"/lecture-13/lecture",permalink:"/sp2022/lecture-13/lecture",tags:[],version:"current",frontMatter:{title:"Lecture",sidebar_label:"Lecture",pagination_next:null,pagination_prev:null,hide_table_of_contents:!1},sidebar:"docs"},c={},u=[{value:"Mongoose",id:"mongoose",level:2},{value:"Default values",id:"default-values",level:3},{value:"Basic validation",id:"basic-validation",level:3},{value:"Required fields",id:"required-fields",level:4},{value:"Number boundaries",id:"number-boundaries",level:4},{value:"Error Handling",id:"error-handling",level:3},{value:"findById()",id:"findbyid",level:3},{value:"findByIdAndRemove()",id:"findbyidandremove",level:3},{value:"Node.js",id:"nodejs",level:2},{value:"Dotenv",id:"dotenv",level:3},{value:"JSON.stringify()",id:"jsonstringify",level:3},{value:"Error-handling middleware",id:"error-handling-middleware",level:3},{value:"Windows Services Manager",id:"windows-services-manager",level:2},{value:"Ref",id:"ref",level:2}],h={toc:u};function m(e){var t=e.components,n=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},h,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"lecture"},"Lecture"),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Lecture Slides will be in OMA after the session."))),(0,o.kt)("h2",{id:"mongoose"},"Mongoose"),(0,o.kt)("h3",{id:"default-values"},"Default values"),(0,o.kt)("p",null,"In some cases, it\u2019s useful to set a default value when a new MongoDB document is created based on your schema. In the noteSchema, the important path is a good candidate. When a new note is added to the database,you can set a default value of false for the importance on each new document. "),(0,o.kt)("p",null,"Mongoose lets you do this from within the schema.\nRemember that ",(0,o.kt)("inlineCode",{parentName:"p"},"important: Boolean")," is shorthand for ",(0,o.kt)("inlineCode",{parentName:"p"},"important: {type: Boolean}")," "),(0,o.kt)("p",null,"You can add other options to the definition object, including a default value. This means that you can update the important path in the schema as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"important: {\n  type: Boolean,\n  'default': false\n}\n")),(0,o.kt)("p",null,"The word default doesn\u2019t have to be in quotes, but it\u2019s a reserved word in JavaScript; therefore, it\u2019s a good idea to use them."),(0,o.kt)("h3",{id:"basic-validation"},"Basic validation"),(0,o.kt)("h4",{id:"required-fields"},"Required fields"),(0,o.kt)("p",null,"Through Mongoose, you can quickly add some basic validation at the schema level. This practice helps maintain data integrity and can protect your database from missing or malformed data. Mongoose\u2019s helpers make it easy to add some of the most common validation tasks, meaning that you don\u2019t have to write or import the code each time."),(0,o.kt)("p",null,"The first example of this type of validation ensures that required fields aren\u2019t empty before saving the document to the database. Rather than writing the checks for each required field in code, you can add a ",(0,o.kt)("inlineCode",{parentName:"p"},"required: true")," flag to the definition objects of each path that you decide should be mandatory. In the noteSchema, you certainly want to ensure that each note has a content, so you can update the name path like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"content: {\n  type: String,\n  required: true\n}\n")),(0,o.kt)("p",null,"If you try to save a note without a content, Mongoose returns a validation error that you can capture immediately in your code without making a round trip to the database."),(0,o.kt)("h4",{id:"number-boundaries"},"Number boundaries"),(0,o.kt)("p",null,"You can use a similar technique to define the maximum and minimum values you want for a number path or minimum length. These validators are called max, min and minLength. "),(0,o.kt)("p",null,"The content field is now required to be at least five characters long\nWe can update the content path as follows:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"content: {\n  type: String,    \n  minLength: 5,    \n  required: true  \n },\n")),(0,o.kt)("p",null,"With this update, Mongoose won\u2019t let you save a content with less  five characters. If you try, it returns a validation error that you can handle in your code. "),(0,o.kt)("p",null,"One great thing about this approach is that the application doesn\u2019t have to make a round trip to the database to check the boundaries. "),(0,o.kt)("p",null,"Another bonus is that you don\u2019t have to write validation code in every place in the application where you might add, update, or calculate a content."),(0,o.kt)("h3",{id:"error-handling"},"Error Handling"),(0,o.kt)("p",null,"There are two classes of errors that can occur with a Mongoose connection."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Error on initial connection. If initial connection fails, Mongoose will emit an 'error' event and the promise mongoose.connect() returns will reject. However, Mongoose will not automatically try to reconnect."),(0,o.kt)("li",{parentName:"ul"},"Error after initial connection was established. Mongoose will attempt to reconnect, and it will emit an 'error' event.")),(0,o.kt)("p",null,"To handle initial connection errors, you should use .catch() or try/catch with async/await."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"mongoose.connect('mongodb://localhost:27017/test').\n  catch(error => handleError(error));\n\n// Or:\ntry {\n  await mongoose.connect('mongodb://localhost:27017/test');\n} catch (error) {\n  handleError(error);\n}\n")),(0,o.kt)("h3",{id:"findbyid"},"findById()"),(0,o.kt)("p",null,"Finds a single document by its _id field. findById(id) is almost equivalent to findOne({ _id: id }). If you want to query by a document's _id, use findById() instead of findOne(). The id is cast based on the Schema before sending the command."),(0,o.kt)("h3",{id:"findbyidandremove"},"findByIdAndRemove()"),(0,o.kt)("p",null,"The findByIdAndRemove() function is used to find a matching document, remove it, passing the found document (if any) to the callback."),(0,o.kt)("h2",{id:"nodejs"},"Node.js"),(0,o.kt)("h3",{id:"dotenv"},"Dotenv"),(0,o.kt)("p",null,(0,o.kt)("a",{parentName:"p",href:"https://github.com/motdotla/dotenv"},"Dotenv ")," is a zero-dependency module that loads environment variables from a .env file into process.env. Storing configuration in the environment separate from code is based on The ",(0,o.kt)("a",{parentName:"p",href:"http://12factor.net/config"},"Twelve-Factor")," App methodology."),(0,o.kt)("h3",{id:"jsonstringify"},"JSON.stringify()"),(0,o.kt)("p",null,"The ",(0,o.kt)("strong",{parentName:"p"},(0,o.kt)("inlineCode",{parentName:"strong"},"JSON.stringify()"))," method converts a JavaScript object\nor value to a JSON string."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Return value"),"\nA JSON string representing the given value, or undefined."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"Using JSON.stringify")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"JSON.stringify({});                    // '{}'\nJSON.stringify(true);                  // 'true'\nJSON.stringify('foo');                 // '\"foo\"'\nJSON.stringify([1, 'false', false]);   // '[1,\"false\",false]'\nJSON.stringify([NaN, null, Infinity]); // '[null,null,null]'\nJSON.stringify({ x: 5 });              // '{\"x\":5}'\n\nJSON.stringify(new Date(2006, 0, 2, 15, 4, 5));\n// '\"2006-01-02T15:04:05.000Z\"'\n\nJSON.stringify({ x: 5, y: 6 });\n// '{\"x\":5,\"y\":6}'\nJSON.stringify([new Number(3), new String('false'), new Boolean(false)]);\n// '[3,\"false\",false]'\n")),(0,o.kt)("h3",{id:"error-handling-middleware"},"Error-handling middleware"),(0,o.kt)("p",null,"There are two types of middleware. The first type take three arguments (sometimes two when next is discarded). Most of the time, your app is in normal mode, which looks only at these middleware functions and skips the other."),(0,o.kt)("p",null,"The second kind  is the error-handling middleware. When your app is in error mode, all regular middleware is ignored and Express will execute only error-handling middleware functions. To enter error mode, simply call next with an argument. It\u2019s convention to call it with an error object."),(0,o.kt)("p",null,"These middleware functions take four arguments instead of two or three. The first one is the error (the argument passed into next), and the remainder are the three from before: req, res, and next. You can do anything you want in this middleware. When you\u2019re done, it\u2019s just like other middleware: you can call res.end or next. Calling next with no arguments will exit error mode and move onto the next normal middleware; calling it with an argument will continue onto the next error-handling middleware if one exists."),(0,o.kt)("p",null,"Let\u2019s say you have four middleware functions in a row. The first two are normal, the third handles errors, and the fourth is normal. If no errors happen, it\u2019ll be as if the error-handling middleware never existed. To reiterate more precisely, \u201cno errors\u201d means \u201cnext was never called with any arguments.\u201d If an error does happen, then Express will skip over all other middleware until the first error-handling middleware in the stack. "),(0,o.kt)("p",null,"While not enforced, error-handling middleware is conventionally placed at the end of your middleware stack, after all the normal middleware has been added. This is because you want to catch any errors that come cascading down from earlier in the stack."),(0,o.kt)("div",{className:"admonition admonition-note alert alert--secondary"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"}))),"No catching")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Express\u2019s error-handling middleware does not handle errors that are thrown with the throw keyword, only when you call next with an argument."))),(0,o.kt)("h2",{id:"windows-services-manager"},"Windows Services Manager"),(0,o.kt)("p",null,"To open the Windows Services Manager on your Windows 11 or Windows 10 computer, do the following:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Right-click on the Start button to open the WinX Menu"),(0,o.kt)("li",{parentName:"ul"},"Select Run"),(0,o.kt)("li",{parentName:"ul"},"Type services.msc in the Run box which opens"),(0,o.kt)("li",{parentName:"ul"},"Windows Services Manager will open.")),(0,o.kt)("h2",{id:"ref"},"Ref"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Express in Action Evan Hahn, Evan M. Hahn"),(0,o.kt)("li",{parentName:"ul"},"Getting MEAN with Mongo, Express, Node"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://www.freecodecamp.org/learn/back-end-development-and-apis/#basic-node-and-express"},"freecodecamp.org")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON/stringify"},"JSON.stringify")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://mongoosejs.com/docs/api.html#model_Model.findById"},"findById")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://mongoosejs.com/docs/promises.html"},"Built-in Promises")),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("a",{parentName:"li",href:"https://mongoosejs.com/docs/api/model.html#model_Model-save"},"Model"))))}m.isMDXComponent=!0}}]);